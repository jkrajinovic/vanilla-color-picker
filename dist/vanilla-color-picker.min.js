!function(e){function t(e,t,i){var n=i?"vanilla-color-picker-single-color-picked":"";return'<div class="vanilla-color-picker-single-color '+n+'" tabindex="'+t+'" data-color="'+e+'" style="background-color:'+e+'"></div>'}function i(){if(!document.getElementById("vanilla-color-picker-style")){var t=document.createElement("style");t.setAttribute("type","text/css"),t.setAttribute("id","vanilla-color-picker-style"),t.innerHTML=l;var i=e.document.head.children[0];i?e.document.head.insertBefore(t,i):e.document.head.appendChild(t)}}function n(){this.subscribers={},this.on=function(e,t){return this.subscribers[e]=this.subscribers[e]||[],this.subscribers[e].push(t),this},this.emit=function(e){var t=arguments;(this.subscribers[e]||[]).forEach(function(e){e.apply(null,Array.prototype.splice.call(t,1))})}}function o(e,i,o,s){n.apply(this),this.targetElem=e,this.elem=null;var r=this;this._initialize=function(){this._createPickerElement(),this._positionPickerElement(),this._addEventListeners()},this.destroy=function(){try{this.elem.parentNode.removeChild(this.elem)}catch(e){}},this._positionPickerElement=function(e){var t=this.targetElem.offsetLeft,i=this.targetElem.offsetTop,n=this.targetElem.offsetHeight;this.elem.style.left=t+"px",this.elem.style.top=i+n+"px"},this._onFocusLost=function(){setTimeout(function(){r.elem.contains(document.activeElement)?document.activeElement.addEventListener("blur",r._onFocusLost):r.emit("lostFocus")},1)},this._createPickerElement=function(e){this.elem=document.createElement("div"),this.elem.classList.add("vanilla-color-picker"),o&&this.elem.classList.add(o);for(var n=i.indexOf(this.targetElem.dataset.vanillaPickerColor),s=0;s<i.length;s++)this.elem.innerHTML+=t(i[s],s+1,s==n);"undefined"==typeof e?this.targetElem.parentNode.parentNode.appendChild(this.elem):document.querySelector(e).appendChild(this.elem),this.elem.setAttribute("tabindex",1);var l=n>-1?n:0;this.elem.children[l].focus(),this.elem.children[l].addEventListener("blur",r._onFocusLost)},this._addEventListeners=function(){var e=this;this.elem.addEventListener("click",function(t){t.target.classList.contains("vanilla-color-picker-single-color")&&e.emit("colorChosen",t.target.dataset.color)}),this.elem.addEventListener("keydown",function(t){var i=13,n=27,o=t.which||t.keyCode;o==i&&e.emit("colorChosen",t.target.dataset.color),o==n&&e.emit("lostFocus")})},this._initialize()}function s(e){n.apply(this),this.set=this.emit,this.colors=c,this.className="",this.containerNode="",this.elem=e,this.currentPicker=null;var t=this;this._initialize=function(){this._addEventListeners()},this._addEventListeners=function(){this.elem.addEventListener("click",this.openPicker),this.elem.addEventListener("focus",this.openPicker),this.on("customColors",function(e){if(!e instanceof Array)throw new Error("Colors must be an array");t.colors=e}),this.on("defaultColor",function(e){t.elem.dataset.vanillaPickerColor||(t._updateElemState(e),t.emit("colorChosen",e,t.elem))}),this.on("className",function(e){t.className=e}),this.on("addContainer",function(e){t.containerNode=e})},this._updateElemState=function(e){this.elem.dataset.vanillaPickerColor=e,this.elem.value=e},this.destroyPicker=function(){t.currentPicker&&(t.currentPicker.destroy(),t.currentPicker=null,t.emit("pickerClosed"))},this.openPicker=function(){t.currentPicker||(t.currentPicker=new o(t.elem,t.colors,t.className,this.containerNode),t.currentPicker.on("colorChosen",function(e){t._updateElemState(e),t.destroyPicker(),t.emit("colorChosen",e,t.elem)}),t.currentPicker.on("lostFocus",function(){t.destroyPicker()}),t.emit("pickerCreated"))},this._initialize()}function r(e,t){return i(),new s(e,t)}var l=".vanilla-color-picker { display: inline-block; position: absolute; padding: 5px; background-color: #fff; box-shadow: 1px 1px 2px 1px rgba(0,0,0,0.3) } .vanilla-color-picker-single-color { display: inline-block; width: 20px; height: 20px; margin: 1px; border-radius: 2px; }",c=["red","yellow","green"];e.define&&e.define.amd?define([],function(){return r}):e.vanillaColorPicker=r}(this||window);